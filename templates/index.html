<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta tags -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
  <meta name="viewport" content="width=device-width" />

  <!-- Favicon and title -->
  <link rel="icon" href="{{ url_for('static', filename='fav.png') }}">
  <title>sigcoder - sigma to anything</title>

  <!-- Halfmoon CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Halfmoon/1.1.1/css/halfmoon.min.css" integrity="sha512-Kaju/JzlErKhC47smofkXAdSkvILovmvh2nnok6rgN79oB3Co/T7Pm7Ns8dcpNEN3VTVZDw2ilrUDByzInEabg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<!-- Prism CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css" integrity="sha512-GZPS1oCebjx8g/ZkrTTvWirW+4wDkzIsilUQPXcZzuDpDzoH5brM2AojiFjo6ObIWeM68ZDostvdjaS9MNYCTg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/line-numbers/prism-line-numbers.min.css" integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<!-- Prism Live CSS -->
	<link rel="stylesheet" href="{{ url_for('static', filename='css/prism-live.css') }}">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

</head>
<body onload="showFormats()" class="with-custom-webkit-scrollbars with-custom-css-scrollbars" data-set-preferred-mode-onload="true"> <!--  data-dm-shortcut-enabled="true" data-set-preferred-mode-onload="true">-->
  <div class="sticky-alerts"></div>

  <!-- Page wrapper start -->
  <div class="page-wrapper with-navbar">

    <!-- Navbar start -->
    <nav class="navbar">
      <!-- Reference: https://www.gethalfmoon.com/docs/navbar -->
        <a href="#" class="navbar-brand">
          sigcoder - sigma into anything
        </a>
    </nav>
    <!-- Navbar end -->

    <!-- Content wrapper start -->
    <div class="content-wrapper">
      <div class="container-fluid font-size-10">
        <!-- Inputs -->
        <div id="inputs" class="row row-eq-spacing">
          <!-- Pipelines: sigma list pipelines -->
          <div class="col-sm-12 col-lg-3">
            <label for="pipeline-select">Select pipeline:</label>
            <select onchange="convert()" class="form-control" id="pipeline-select">
              <option selected value></option>
              {% for name in pipelines.pipelines.keys() %}
              <option value="{{ name }}">{{ name }}</option>
              {% endfor %}
            </select>
          </div>
          <!-- Targets: sigma list targets -->
          <div class="col-sm-12 col-lg-3">
            <label for="target-select">Select backend:</label>
            <select onchange="showFormats(); convert()" class="form-control" id="target-select">
              {% for name, backend in backends.items() %}
              <option value="{{ name }}">{{ backend.text }}</option>
              {% endfor %}
            </select>
          </div>
          <!-- Format: sigma list format <backend> -->
          <div class="col-sm-12 col-lg-3">
            <label for="format-select">Select format:</label>
            <select onchange="convert()" class="form-control" id="format-select">
              {% for format in formats %}
              <option hidden backend="{{ format.backend }}" value="{{ format.name }}">{{ format.description }}</option>
              {% endfor %}
            </select>
          </div>
          <!-- Copy Button -->
          <div class="col-sm-6 col-lg-1 offset-lg-1 d-flex justify-content-end align-self-center">
            <button onclick="copy()" id="copy-button" class="btn btn-rounded btn-primary mt-15" type="button">Copy</button>
          </div>
          <!-- Convert Button -->
          <div class="col-sm-6 col-lg-1 d-flex justify-content-end align-self-center">
            <button onclick="convert()" id="convert-button" class="btn btn-rounded btn-primary mt-15" type="button">Convert ></button>
          </div>
        </div>
        <!-- Code Area -->
        <div class="row row-eq-spacing justify-content-center">
          <div class="col-sm-12 col-lg-6 justify-content-center">
            <textarea id="input-textarea" class="prism-live line-numbers language-yml fill overflow-y-hidden" spellcheck="false">
title: Suspicious SYSTEM User Process Creation
id: 2617e7ed-adb7-40ba-b0f3-8f9945fe6c09
status: test
description: Detects a suspicious process creation as SYSTEM user (suspicious program or command line parameter)
references:
    - Internal Research
    - https://tools.thehacker.recipes/mimikatz/modules
author: Florian Roth (rule), David ANDRE (additional keywords)
date: 2021/12/20
modified: 2022/04/27
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        IntegrityLevel: System
        User|contains: # covers many language settings
            - 'AUTHORI'
            - 'AUTORI'
    selection_special:
        - Image|endswith:
            - '\calc.exe'
            - '\wscript.exe'
            - '\cscript.exe'
            - '\hh.exe'
            - '\mshta.exe'
            - '\forfiles.exe'
            - '\ping.exe'
        - CommandLine|contains:
            # - 'sc stop ' # stops a system service # causes FPs
            - ' -NoP '  # Often used in malicious PowerShell commands
            - ' -W Hidden '  # Often used in malicious PowerShell commands
            - ' -decode '  # Used with certutil
            - ' /decode '  # Used with certutil
            - ' /urlcache '  # Used with certutil
            - ' -urlcache '  # Used with certutil
            - ' -e* JAB'  # PowerShell encoded commands
            - ' -e* SUVYI'  # PowerShell encoded commands
            - ' -e* SQBFAFgA'  # PowerShell encoded commands
            - ' -e* aWV4I'  # PowerShell encoded commands
            - ' -e* IAB'  # PowerShell ncoded commands
            - ' -e* PAA'  # PowerShell encoded commands
            - ' -e* aQBlAHgA'  # PowerShell encoded commands
            - 'vssadmin delete shadows'  # Ransomware
            - 'reg SAVE HKLM'  # save registry SAM - syskey extraction
            - ' -ma '  # ProcDump
            - 'Microsoft\Windows\CurrentVersion\Run'  # Run key in command line - often in combination with REG ADD
            - '.downloadstring('  # PowerShell download command
            - '.downloadfile('  # PowerShell download command
            - ' /ticket:'  # Rubeus
            - 'dpapi::'     #Mimikatz
            - 'event::clear'        #Mimikatz
            - 'event::drop'     #Mimikatz
            - 'id::modify'      #Mimikatz
            - 'kerberos::'       #Mimikatz
            - 'lsadump::'      #Mimikatz
            - 'misc::'     #Mimikatz
            - 'privilege::'       #Mimikatz
            - 'rpc::'      #Mimikatz
            - 'sekurlsa::'       #Mimikatz
            - 'sid::'        #Mimikatz
            - 'token::'      #Mimikatz
            - 'vault::cred'     #Mimikatz
            - 'vault::list'     #Mimikatz
            - ' p::d '  # Mimikatz
            - ';iex('  # PowerShell IEX
            - 'MiniDump'  # Process dumping method apart from procdump
            - 'net user '
    condition: all of selection*
falsepositives:
    - Administrative activity
    - Scripts and administrative tools used in the monitored environment
    - Monitoring activity
level: high
            </textarea>
          </div>
          <div class="col-sm-12 col-lg-6 justify-content-center">
            <textarea hidden id="result-textarea" class="prism-live line-numbers language-splunk-spl fill overflow-y-hidden" spellcheck="false" disabled>Output will be displayed here</textarea>
          </div>
        </div>
      </div>
    </div>
    <!-- Content wrapper end -->

  </div>
  <!-- Page wrapper end -->

	<!-- Halfmoon JS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Halfmoon/1.1.1/js/halfmoon.min.js" integrity="sha512-8fN/MQrHBCMmkx2t4QwGODGHwQf8VxCeNwNkJz0gjt5JrlUfJ5zNlMr9lrzhnl7DSN+5E16YmMHnfomnQmvSoA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<!-- PrismJS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/blissfuljs/1.0.6/bliss.shy.min.js" integrity="sha512-MxBdQXQ8H/eviAINQi9I3C5hl/mG7hbiB5KEAUdKcr0CVJpjmyXNyRSh4wIzX3/5oHK8L1B8svUuKXWu70RAVA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/prism.min.js" integrity="sha512-RDQSW3KoqJMiX0L/UBgwBmH1EmRYp8LBOiLaA8rBHIy+7OGP/7Gxg8vbt8wG4ZYd29P0Fnoq6+LOytCqx3cyoQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-BttltKXFyWnGZQcRWj6osIg7lbizJchuAMotOkdLxHxwt/Hyo+cl47bZU0QADg+Qt5DJwni3SbYGXeGMB5cBcw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-yaml.min.js" integrity="sha512-6O/PZimM3TD1NN3yrazePA4AbZrPcwt1QCGJrVY7WoHDJROZFc9TlBvIKMe+QfqgcslW4lQeBzNJEJvIMC8WhA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-splunk-spl.min.js" integrity="sha512-RLhcqVEXOdbZPCJ8YG5fZDRIK3nXiS6erMtnzLyaKzS17H7mRi/9a1o+s2TM2XlWk4Nk7E579LyL63R7nUlrgQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<!-- PrismLiveJS -->
  <script src="{{ url_for('static', filename='js/prism-live.js') }}"></script>
  <script src="{{ url_for('static', filename='js/prism-live-markup.js') }}"></script>
  <script src="{{ url_for('static', filename='js/prism-live-css.js') }}"></script>
  <script src="{{ url_for('static', filename='js/prism-live-javascript.js') }}"></script>
  <script src="{{ url_for('static', filename='js/index.js') }}"></script>
</body>
</html>
